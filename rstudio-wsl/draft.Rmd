---
title: "Using RStudio Server on Windows"
date: "Last updated on `r Sys.Date()`"
output:
  bookdown::html_document2:
    keep_md: true
    number_sections: false
    toc: true
toc-title: "Table of Contents"
knit: "bookdown::render_book"
---

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy(lang = c("bash", "r", "markdown"))

knitr::opts_chunk$set(eval=FALSE, tidy = "styler")
```

## Introduction {#intro}

This article explains about how to set up RStudio Server on Windows platform.

As RStudio Server has primarily been designed to work with Linux distributions, Windows users must require a virtualization technology, called ["Windows Subsystem for Linux" (WSL)](https://docs.microsoft.com/en-us/windows/wsl/){target="_blank"}, to run a Linux kernel inside their system.

## Prerequisite {#prereq}

We recommend using the enhanced WSL (version 2) for setting up RStudio Server, which requires **Windows 10 (Version 2004; Build 19041 or higher)**.

1. You can check your Windows version by pressing the `Windows logo key + R`, type `winver`, and hit enter.
1. In case your system is lower than the suggested version, please [update to the latest Windows version](ms-settings:windowsupdate){target="_blank"}.

* **Note:** For builds lower than 19041, WSL is not supported at all.

## WSL Setup {#wsl-setup}

Once you have met the [prerequisite](#prereq), you need to enable WSL features on your system.

* **Note:** Use "Copy code" button below to easily copy all the required commands to clipboard and paste it directly into your PowerShell by pressing `Ctrl + V` key. Note that you have to hit enter key to execute the pasted code chunk in the console.

1. Open "Windows PowerShell" with admin privileges.
1. Turn on the WSL feature using the following command in the PowerShell:

    ```{bash}
    dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
    ```

1. Enable the "Virtual Machine Platform" feature by running the following command in the PowerShell:

    ```{bash}
    dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
    ```

1. Restart your system.
1. Open "Windows PowerShell" with admin privileges again.
1. Set WSL 2 as your default version using the following command in the PowerShell:

    ```{bash}
    wsl --set-default-version 2
    ```

1. Download and install [the latest WSL2 Linux kernel](https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi) if you see the following message:

    > WSL 2 requires an update to its kernel component. For information please visit `https://aka.ms/wsl2kernel`

## Linux Distribution Setup {#linux-setup}

After the [WSL 2 feature](#wsl-setup) has been enabled, you have to download and install a Linux distribution from [Microsoft Store](https://aka.ms/wslstore){target="_blank"}.

Alternatively, you can also download and manually install Linux distros by clicking any of the links below:

* [Ubuntu 20.04](https://aka.ms/wslubuntu2004)
* [Ubuntu 20.04 ARM](https://aka.ms/wslubuntu2004arm)
* [Ubuntu 18.04](https://aka.ms/wsl-ubuntu-1804)
* [Ubuntu 18.04 ARM](https://aka.ms/wsl-ubuntu-1804-arm)
* [Ubuntu 16.04](https://aka.ms/wsl-ubuntu-1604)
* [Debian GNU/Linux](https://aka.ms/wsl-debian-gnulinux)
* [Kali Linux](https://aka.ms/wsl-kali-linux-new)
* [OpenSUSE Leap 42](https://aka.ms/wsl-opensuse-42)
* [SUSE Linux Enterprise Server 12](https://aka.ms/wsl-sles-12)
* [Fedora Remix for WSL](https://github.com/WhitewaterFoundry/WSLFedoraRemix/releases/)

We will download and install ["Ubuntu 20.04"](https://aka.ms/wslubuntu2004) as an example for this article.

Once the distribution has been installed and launched, you will be prompted the initial user configuration like below:

> Installing, this may take a few minutes...                                                                                                             
> 
> Please create a default UNIX user account. The username does not need to match your Windows username.                                                  
> For more information visit: `https://aka.ms/wslusers` 
> 
> Enter new UNIX username:                                                                                                                               
  
Provide a user name followed by password that will be used for both your WSL distribution and RStudio Server authentication later on.

You can now close the WSL instance by typing the following command:
   
```{bash}
exit
```

* **Note:** Unlike the PowerShell, you cannot use `Ctrl + V` shortcut key to paste the clipboard content into the WSL terminal. Alternatively, press mouse right-click button to emulate the paste function.

## RStudio Server Setup {#rstudio-server-setup}

Now that you have successfully installed a Linux distribution on your system via WSL, you can setup and run RStudio Server by following the procedures below:

1. Type `wsl` in either PowerShell or CMD terminal to launch your installed linux distro.
1. Make sure your Linux packages up-to-date using the following command (we will assume that you have installed a Ubuntu distribution):

    ```{bash}
    sudo apt-get update
    sudo apt-get upgrade -y
    ```

    * **Note:** Provide the password of your user account that you created for the Linux system, not the Windows password to log in for your PC.

1. Add the following apt credential to your repository list  for Getting the Latest R (v4.0.0 as of this writing):

    ```{bash}
    sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9
    sudo add-apt-repository 'deb https://cloud.r-project.org/bin/linux/ubuntu focal-cran40/'
    ```

    * **Note:** More detailed information on installing the latest R for Linux can be found at [the official CRAN page](https://cran.r-project.org/bin/linux/ubuntu/){target="_blank"}.

1. Install R with some essential dependencies for the RStudio Server and devtools:

    ```{bash}
    sudo apt install -y r-base r-base-core r-recommended r-base-dev gdebi-core build-essential libcurl4-gnutls-dev libxml2-dev libssl-dev
    ```

1. Obtain the download URL of the RStudio Server you want to install.

    * **Note:** You can explore some RStudio download pages, such as [RStudio Release](https://rstudio.com/products/rstudio/download/#download){target="_blank"}, [RStudio Preview (close to release)](https://rstudio.com/products/rstudio/download/preview/){target="_blank"}, and [RStudio Daily](https://dailies.rstudio.com/){target="_blank"}. Make sure you choose RStudio *Server* (not Desktop) and match with your installed Linux distribution type and version.

1. Install RStudio Server:

    ```{bash}
    wget https://s3.amazonaws.com/rstudio-ide-build/server/bionic/amd64/rstudio-server-1.4.467-amd64.deb
    sudo gdebi rstudio-server-1.4.467-amd64.deb
    ```

    * **Note1:**We have downloaded the daily version, `rstudio-server-1.4.467-amd64.deb` for this demonstration; however, the URL and file name can vary depending on what you have chosen.

    * **Note2:** You may be prompted a warning message like "Couldn't find an alternative telinit implementation to spawn." However, our testing results have revealed that there is no issue with using RStudio Server regardless of this warning.

1. Launch RStudio Server:

    ```{bash}
    sudo rstudio-server start
    ```

    * **Note:** If there was no error message, you can assume that your RStudio Server has been successfully loaded.
      
1. Access your server at [http://localhost:8787](http://localhost:8787){target="_blank"}.

    * **Note:** The user name and password are the same as your Linux  system's.
